/**
   * @license
   * author: yuanzeyu@onchain.com
   * ontlogin.js v0.0.5
   * Released under the ISC license.
   */
var ontlogin=function(e){"use strict";var t,r,s,o;e.Version=void 0,(e.Version||(e.Version={})).Version1="1.0",e.MessageType=void 0,(t=e.MessageType||(e.MessageType={})).ClientHello="ClientHello",t.ServerHello="ServerHello",t.ClientResponse="ClientResponse",e.Action=void 0,(r=e.Action||(e.Action={}))[r.IdAuth=0]="IdAuth",r[r.IdAuthAndVcAuth=1]="IdAuthAndVcAuth",e.Error=void 0,function(e){e.VersionNotSupport="ERR_WRONG_VERSION",e.TypeNotSupport="ERR_TYPE_NOT_SUPPORTED",e.ActionNotSupport="ERR_ACTION_NOT_SUPPORTED",e.UnknownError="ERR_UNDEFINED"}(e.Error||(e.Error={})),e.QrStatus=void 0,(s=e.QrStatus||(e.QrStatus={}))[s.Pending=0]="Pending",s[s.Success=1]="Success",s[s.Fail=2]="Fail",e.RequestUrl=void 0,(o=e.RequestUrl||(e.RequestUrl={})).getQr="http://172.168.3.240:31843/qr-code/challenge",o.getQrResult="http://172.168.3.240:31843/qr-code/result";const n=async(e,t)=>fetch(e,{method:"post",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((e=>e.json())),i=async(e,t)=>fetch(`${e}/${t}`).then((e=>e.json())),u=e=>new Promise((t=>{setTimeout((()=>{t()}),e)})),a=async(t,r=1e3)=>{const{result:s,error:o,desc:n}=await i(e.RequestUrl.getQrResult,t);if(o)throw new Error(n);if(s.state===e.QrStatus.Pending)return await u(r),a(t);if(s.state===e.QrStatus.Success)return JSON.parse(s.clientResponse);throw new Error(s.error)};return e.createAuthRequest=t=>({ver:e.Version.Version1,type:e.MessageType.ClientHello,action:t}),e.createSignData=(e,t)=>({type:"ClientResponse",server:{name:e.server.name,url:e.server.url,...e.server.did?{did:e.server.did}:{}},nonce:e.nonce,did:t,created:Math.floor(Date.now()/1e3)}),e.getRequest=i,e.postRequest=n,e.queryQRResult=a,e.requestQR=async t=>{const{result:r,error:s,desc:o}=await n(e.RequestUrl.getQr,t);if(s)throw new Error(o);return{id:r.id,text:r.qrCode}},e.wait=u,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
